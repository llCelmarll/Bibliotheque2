
> frontend@1.0.0 test
> jest --runInBand

[baseline-browser-mapping] The data in this module is over two months old.  To ensure accurate Baseline data, please update: `npm i baseline-browser-mapping@latest -D`
PASS __tests__/components/BookCover.test.tsx
PASS __tests__/components/ClickableTag.test.tsx
PASS __tests__/hooks/useLoans.test.ts
  ‚óè Console

    console.error
      An update to HookContainer inside a test was not wrapped in act(...).
      
      When testing, code that causes React state updates should be wrapped into act(...):
      
      act(() => {
        /* fire events that update state */
      });
      /* assert on the output */
      
      This ensures that you're testing the behavior the user would see in the browser. Learn more at https://react.dev/link/wrap-tests-with-act

    [0m [90m 47 |[39m       }
     [90m 48 |[39m
    [31m[1m>[22m[39m[90m 49 |[39m       setLoans(data)[33m;[39m
     [90m    |[39m       [31m[1m^[22m[39m
     [90m 50 |[39m     } [36mcatch[39m (err) {
     [90m 51 |[39m       console[33m.[39merror([32m'Erreur lors du chargement des pr√™ts:'[39m[33m,[39m err)[33m;[39m
     [90m 52 |[39m       setError([32m'Impossible de charger les pr√™ts'[39m)[33m;[39m[0m

      at node_modules/react-test-renderer/cjs/react-test-renderer.development.js:11801:19
      at runWithFiberInDEV (node_modules/react-test-renderer/cjs/react-test-renderer.development.js:1574:13)
      at warnIfUpdatesNotWrappedWithActDEV (node_modules/react-test-renderer/cjs/react-test-renderer.development.js:11800:9)
      at scheduleUpdateOnFiber (node_modules/react-test-renderer/cjs/react-test-renderer.development.js:10326:9)
      at dispatchSetStateInternal (node_modules/react-test-renderer/cjs/react-test-renderer.development.js:4148:13)
      at dispatchSetState (node_modules/react-test-renderer/cjs/react-test-renderer.development.js:4107:7)
      at setLoans (hooks/useLoans.ts:49:7)
      at asyncGeneratorStep (node_modules/@babel/runtime/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyncToGenerator.js:17:9)

    console.error
      An update to HookContainer inside a test was not wrapped in act(...).
      
      When testing, code that causes React state updates should be wrapped into act(...):
      
      act(() => {
        /* fire events that update state */
      });
      /* assert on the output */
      
      This ensures that you're testing the behavior the user would see in the browser. Learn more at https://react.dev/link/wrap-tests-with-act

    [0m [90m 52 |[39m       setError([32m'Impossible de charger les pr√™ts'[39m)[33m;[39m
     [90m 53 |[39m     } [36mfinally[39m {
    [31m[1m>[22m[39m[90m 54 |[39m       setLoading([36mfalse[39m)[33m;[39m
     [90m    |[39m       [31m[1m^[22m[39m
     [90m 55 |[39m     }
     [90m 56 |[39m   }[33m,[39m [isAuthenticated[33m,[39m filterStatus])[33m;[39m
     [90m 57 |[39m[0m

      at node_modules/react-test-renderer/cjs/react-test-renderer.development.js:11801:19
      at runWithFiberInDEV (node_modules/react-test-renderer/cjs/react-test-renderer.development.js:1574:13)
      at warnIfUpdatesNotWrappedWithActDEV (node_modules/react-test-renderer/cjs/react-test-renderer.development.js:11800:9)
      at scheduleUpdateOnFiber (node_modules/react-test-renderer/cjs/react-test-renderer.development.js:10326:9)
      at dispatchSetStateInternal (node_modules/react-test-renderer/cjs/react-test-renderer.development.js:4148:13)
      at dispatchSetState (node_modules/react-test-renderer/cjs/react-test-renderer.development.js:4107:7)
      at setLoading (hooks/useLoans.ts:54:7)
      at asyncGeneratorStep (node_modules/@babel/runtime/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyncToGenerator.js:17:9)

    console.error
      An update to HookContainer inside a test was not wrapped in act(...).
      
      When testing, code that causes React state updates should be wrapped into act(...):
      
      act(() => {
        /* fire events that update state */
      });
      /* assert on the output */
      
      This ensures that you're testing the behavior the user would see in the browser. Learn more at https://react.dev/link/wrap-tests-with-act

    [0m [90m 64 |[39m     [36mtry[39m {
     [90m 65 |[39m       [36mconst[39m stats [33m=[39m [36mawait[39m loanService[33m.[39mgetStatistics()[33m;[39m
    [31m[1m>[22m[39m[90m 66 |[39m       setStatistics(stats)[33m;[39m
     [90m    |[39m       [31m[1m^[22m[39m
     [90m 67 |[39m     } [36mcatch[39m (err) {
     [90m 68 |[39m       console[33m.[39merror([32m'Erreur lors du chargement des statistiques:'[39m[33m,[39m err)[33m;[39m
     [90m 69 |[39m     }[0m

      at node_modules/react-test-renderer/cjs/react-test-renderer.development.js:11801:19
      at runWithFiberInDEV (node_modules/react-test-renderer/cjs/react-test-renderer.development.js:1574:13)
      at warnIfUpdatesNotWrappedWithActDEV (node_modules/react-test-renderer/cjs/react-test-renderer.development.js:11800:9)
      at scheduleUpdateOnFiber (node_modules/react-test-renderer/cjs/react-test-renderer.development.js:10326:9)
      at dispatchSetStateInternal (node_modules/react-test-renderer/cjs/react-test-renderer.development.js:4148:13)
      at dispatchSetState (node_modules/react-test-renderer/cjs/react-test-renderer.development.js:4107:7)
      at setStatistics (hooks/useLoans.ts:66:7)
      at asyncGeneratorStep (node_modules/@babel/runtime/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyncToGenerator.js:17:9)

PASS __tests__/components/BookListItem.test.tsx
PASS __tests__/components/SearchBar.test.tsx
PASS __tests__/setup.test.ts
PASS __tests__/components/BookDetail/BookActions.test.tsx
  ‚óè Console

    console.log
      üì• Bouton Retourner cliqu√©

      at log (components/BookDetail/BookActions.tsx:44:13)

    console.log
      üì• Bouton Retourner cliqu√©

      at log (components/BookDetail/BookActions.tsx:44:13)

    console.log
      üì• Bouton Retourner cliqu√©

      at log (components/BookDetail/BookActions.tsx:44:13)

    console.log
      üì• Bouton Retourner cliqu√©

      at log (components/BookDetail/BookActions.tsx:44:13)

    console.log
      üîß Bouton Modifier cliqu√© - Navigation vers l'√©cran d'√©dition

      at log (components/BookDetail/BookActions.tsx:26:13)


ReferenceError: You are trying to `import` a file after the Jest environment has been torn down. From __tests__/components/BookDetail/BookActions.test.tsx.

    [0m [90m 76 |[39m       [36mawait[39m loanService[33m.[39mreturnLoan(currentLoan[33m.[39mid)[33m;[39m
     [90m 77 |[39m
    [31m[1m>[22m[39m[90m 78 |[39m       [36mif[39m ([33mPlatform[39m[33m.[39m[33mOS[39m [33m===[39m [32m'web'[39m) {
     [90m    |[39m           [31m[1m^[22m[39m
     [90m 79 |[39m         window[33m.[39malert([32m'Le livre a √©t√© retourn√© avec succ√®s.'[39m)[33m;[39m
     [90m 80 |[39m         window[33m.[39mlocation[33m.[39mreload()[33m;[39m [90m// Rafra√Æchir la page[39m
     [90m 81 |[39m       } [36melse[39m {[0m

      at Object.require [as Platform] (node_modules/react-native/index.js:267:12)
      at Platform (components/BookDetail/BookActions.tsx:78:11)
      at asyncGeneratorStep (node_modules/@babel/runtime/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyncToGenerator.js:17:9)
FAIL __tests__/components/loans/LoanListItem.test.tsx
  ‚óè LoanListItem ‚Ä∫ should render loan information correctly




PASS __tests__/components/loans/BorrowerListItem.test.tsx
PASS components/__tests__/StyledText-test.js
PASS __tests__/services/loanService.test.ts
  ‚óè Console

    console.log
      ‚ûï Cr√©ation pr√™t - donn√©es: {
        "book_id": 1,
        "borrower": 1,
        "due_date": "2025-12-31"
      }

      at LoanService.log (services/loanService.ts:141:13)

    console.log
      ‚úÖ Pr√™t cr√©√© avec succ√®s: {
        id: 1,
        book_id: 1,
        borrower_id: 1,
        loan_date: '2025-01-01',
        due_date: '2025-12-31',
        status: 'active'
      }

      at LoanService.log (services/loanService.ts:145:15)

    console.log
      ‚ûï Cr√©ation pr√™t - donn√©es: {
        "book_id": 1,
        "borrower": 1
      }

      at LoanService.log (services/loanService.ts:141:13)

    console.error
      ‚ùå Erreur lors de la cr√©ation du pr√™t: {
        response: { status: 400, data: { detail: 'Le livre est d√©j√† pr√™t√©' } }
      }

    [0m [90m 146 |[39m       [36mreturn[39m response[33m.[39mdata[33m;[39m
     [90m 147 |[39m     } [36mcatch[39m (error) {
    [31m[1m>[22m[39m[90m 148 |[39m       console[33m.[39merror([32m'‚ùå Erreur lors de la cr√©ation du pr√™t:'[39m[33m,[39m error)[33m;[39m
     [90m     |[39m               [31m[1m^[22m[39m
     [90m 149 |[39m       [36mthrow[39m error[33m;[39m
     [90m 150 |[39m     }
     [90m 151 |[39m   }[0m

      at LoanService.error (services/loanService.ts:148:15)
          at Generator.throw (<anonymous>)
      at asyncGeneratorStep (node_modules/@babel/runtime/helpers/asyncToGenerator.js:3:17)
      at _throw (node_modules/@babel/runtime/helpers/asyncToGenerator.js:20:9)

    console.log
      ‚Ü©Ô∏è Retour du pr√™t - ID: 1

      at LoanService.log (services/loanService.ts:173:13)

    console.log
      ‚úÖ Retour enregistr√© avec succ√®s: { id: 1, status: 'returned', return_date: '2025-01-15' }

      at LoanService.log (services/loanService.ts:177:15)

    console.log
      ‚Ü©Ô∏è Retour du pr√™t - ID: 1

      at LoanService.log (services/loanService.ts:173:13)

    console.error
      ‚ùå Erreur lors de l'enregistrement du retour: {
        response: { status: 400, data: { detail: 'Le livre a d√©j√† √©t√© retourn√©' } }
      }

    [0m [90m 178 |[39m       [36mreturn[39m response[33m.[39mdata[33m;[39m
     [90m 179 |[39m     } [36mcatch[39m (error) {
    [31m[1m>[22m[39m[90m 180 |[39m       console[33m.[39merror([32m'‚ùå Erreur lors de l\'enregistrement du retour:'[39m[33m,[39m error)[33m;[39m
     [90m     |[39m               [31m[1m^[22m[39m
     [90m 181 |[39m       [36mthrow[39m error[33m;[39m
     [90m 182 |[39m     }
     [90m 183 |[39m   }[0m

      at LoanService.error (services/loanService.ts:180:15)
          at Generator.throw (<anonymous>)
      at asyncGeneratorStep (node_modules/@babel/runtime/helpers/asyncToGenerator.js:3:17)
      at _throw (node_modules/@babel/runtime/helpers/asyncToGenerator.js:20:9)

    console.log
      üìã R√©cup√©ration de tous les pr√™ts

      at LoanService.log (services/loanService.ts:25:13)

    console.log
      ‚úÖ Pr√™ts r√©cup√©r√©s: 2

      at LoanService.log (services/loanService.ts:29:15)

    console.log
      üë§ R√©cup√©ration des pr√™ts pour l'emprunteur - ID: 1

      at LoanService.log (services/loanService.ts:121:13)

    console.log
      ‚úÖ Pr√™ts de l'emprunteur r√©cup√©r√©s: 1

      at LoanService.log (services/loanService.ts:125:15)

    console.log
      üìä R√©cup√©ration des statistiques

      at LoanService.log (services/loanService.ts:89:13)

    console.log
      ‚úÖ Statistiques r√©cup√©r√©es: {
        total_loans: 10,
        active_loans: 5,
        overdue_loans: 2,
        returned_loans: 5
      }

      at LoanService.log (services/loanService.ts:93:15)

    console.log
      üóëÔ∏è Suppression pr√™t - ID: 1

      at LoanService.log (services/loanService.ts:189:13)

    console.log
      ‚úÖ Pr√™t supprim√© avec succ√®s

      at LoanService.log (services/loanService.ts:193:15)

    console.log
      üìù Mise √† jour pr√™t - ID: 1 donn√©es: {
        "due_date": "2025-02-28",
        "notes": "Extension demand√©e"
      }

      at LoanService.log (services/loanService.ts:157:13)

    console.log
      ‚úÖ Pr√™t mis √† jour avec succ√®s: { id: 1, due_date: '2025-02-28', notes: 'Extension demand√©e' }

      at LoanService.log (services/loanService.ts:161:15)

PASS __tests__/services/borrowerService.test.ts
  ‚óè Console

    console.log
      ‚ûï Cr√©ation emprunteur - donn√©es: {
        "name": "Jean Dupont",
        "email": "jean@example.com",
        "phone": "0123456789"
      }

      at BorrowerService.log (services/borrowerService.ts:75:13)

    console.log
      ‚úÖ Emprunteur cr√©√© avec succ√®s: {
        id: 1,
        name: 'Jean Dupont',
        email: 'jean@example.com',
        phone: '0123456789',
        created_at: '2025-01-01',
        active_loans_count: 0
      }

      at BorrowerService.log (services/borrowerService.ts:79:15)

    console.log
      ‚ûï Cr√©ation emprunteur - donn√©es: {
        "name": "Jean Dupont"
      }

      at BorrowerService.log (services/borrowerService.ts:75:13)

    console.error
      ‚ùå Erreur lors de la cr√©ation de l'emprunteur: {
        response: {
          status: 409,
          data: { detail: 'Un emprunteur avec ce nom existe d√©j√†' }
        }
      }

    [0m [90m 80 |[39m       [36mreturn[39m response[33m.[39mdata[33m;[39m
     [90m 81 |[39m     } [36mcatch[39m (error) {
    [31m[1m>[22m[39m[90m 82 |[39m       console[33m.[39merror([32m'‚ùå Erreur lors de la cr√©ation de l\'emprunteur:'[39m[33m,[39m error)[33m;[39m
     [90m    |[39m               [31m[1m^[22m[39m
     [90m 83 |[39m       [36mthrow[39m error[33m;[39m
     [90m 84 |[39m     }
     [90m 85 |[39m   }[0m

      at BorrowerService.error (services/borrowerService.ts:82:15)
          at Generator.throw (<anonymous>)
      at asyncGeneratorStep (node_modules/@babel/runtime/helpers/asyncToGenerator.js:3:17)
      at _throw (node_modules/@babel/runtime/helpers/asyncToGenerator.js:20:9)

    console.log
      üìã R√©cup√©ration de tous les emprunteurs

      at BorrowerService.log (services/borrowerService.ts:25:13)

    console.log
      ‚úÖ Emprunteurs r√©cup√©r√©s: 2

      at BorrowerService.log (services/borrowerService.ts:29:15)

    console.log
      üìã R√©cup√©ration de tous les emprunteurs

      at BorrowerService.log (services/borrowerService.ts:25:13)

    console.log
      ‚úÖ Emprunteurs r√©cup√©r√©s: 1

      at BorrowerService.log (services/borrowerService.ts:29:15)

    console.log
      üîç R√©cup√©ration emprunteur - ID: 1

      at BorrowerService.log (services/borrowerService.ts:41:13)

    console.log
      ‚úÖ Emprunteur r√©cup√©r√©: {
        id: 1,
        name: 'Jean Dupont',
        email: 'jean@example.com',
        phone: '0123456789',
        notes: 'Ami de confiance',
        created_at: '2025-01-01',
        active_loans_count: 2
      }

      at BorrowerService.log (services/borrowerService.ts:45:15)

    console.log
      üîç R√©cup√©ration emprunteur - ID: 1

      at BorrowerService.log (services/borrowerService.ts:41:13)

    console.log
      ‚úÖ Emprunteur r√©cup√©r√©: { id: 1, name: 'Test', active_loans_count: 5 }

      at BorrowerService.log (services/borrowerService.ts:45:15)

    console.log
      üîç R√©cup√©ration emprunteur - ID: 999

      at BorrowerService.log (services/borrowerService.ts:41:13)

    console.error
      ‚ùå Erreur lors de la r√©cup√©ration de l'emprunteur: {
        response: { status: 404, data: { detail: 'Emprunteur introuvable' } }
      }

    [0m [90m 46 |[39m       [36mreturn[39m response[33m.[39mdata[33m;[39m
     [90m 47 |[39m     } [36mcatch[39m (error) {
    [31m[1m>[22m[39m[90m 48 |[39m       console[33m.[39merror([32m'‚ùå Erreur lors de la r√©cup√©ration de l\'emprunteur:'[39m[33m,[39m error)[33m;[39m
     [90m    |[39m               [31m[1m^[22m[39m
     [90m 49 |[39m       [36mthrow[39m error[33m;[39m
     [90m 50 |[39m     }
     [90m 51 |[39m   }[0m

      at BorrowerService.error (services/borrowerService.ts:48:15)
          at Generator.throw (<anonymous>)
      at asyncGeneratorStep (node_modules/@babel/runtime/helpers/asyncToGenerator.js:3:17)
      at _throw (node_modules/@babel/runtime/helpers/asyncToGenerator.js:20:9)

    console.log
      üìù Mise √† jour emprunteur - ID: 1 donn√©es: {
        "name": "Jean-Pierre Dupont",
        "email": "jp.dupont@example.com"
      }

      at BorrowerService.log (services/borrowerService.ts:91:13)

    console.log
      ‚úÖ Emprunteur mis √† jour avec succ√®s: {
        id: 1,
        name: 'Jean-Pierre Dupont',
        email: 'jp.dupont@example.com',
        created_at: '2025-01-01',
        active_loans_count: 2
      }

      at BorrowerService.log (services/borrowerService.ts:95:15)

    console.log
      üìù Mise √† jour emprunteur - ID: 1 donn√©es: {
        "name": "Updated Name"
      }

      at BorrowerService.log (services/borrowerService.ts:91:13)

    console.log
      ‚úÖ Emprunteur mis √† jour avec succ√®s: { id: 1, name: 'Updated Name', active_loans_count: 3 }

      at BorrowerService.log (services/borrowerService.ts:95:15)

    console.log
      üóëÔ∏è Suppression emprunteur - ID: 1

      at BorrowerService.log (services/borrowerService.ts:107:13)

    console.log
      ‚úÖ Emprunteur supprim√© avec succ√®s

      at BorrowerService.log (services/borrowerService.ts:111:15)

    console.log
      üóëÔ∏è Suppression emprunteur - ID: 1

      at BorrowerService.log (services/borrowerService.ts:107:13)

    console.error
      ‚ùå Erreur lors de la suppression de l'emprunteur: {
        response: {
          status: 400,
          data: {
            detail: 'Impossible de supprimer un emprunteur avec des pr√™ts actifs'
          }
        }
      }

    [0m [90m 111 |[39m       console[33m.[39mlog([32m'‚úÖ Emprunteur supprim√© avec succ√®s'[39m)[33m;[39m
     [90m 112 |[39m     } [36mcatch[39m (error) {
    [31m[1m>[22m[39m[90m 113 |[39m       console[33m.[39merror([32m'‚ùå Erreur lors de la suppression de l\'emprunteur:'[39m[33m,[39m error)[33m;[39m
     [90m     |[39m               [31m[1m^[22m[39m
     [90m 114 |[39m       [36mthrow[39m error[33m;[39m
     [90m 115 |[39m     }
     [90m 116 |[39m   }[0m

      at BorrowerService.error (services/borrowerService.ts:113:15)
          at Generator.throw (<anonymous>)
      at asyncGeneratorStep (node_modules/@babel/runtime/helpers/asyncToGenerator.js:3:17)
      at _throw (node_modules/@babel/runtime/helpers/asyncToGenerator.js:20:9)

    console.log
      üîé Recherche emprunteurs - query: Jean

      at BorrowerService.log (services/borrowerService.ts:57:13)

    console.log
      ‚úÖ R√©sultats de recherche: 2

      at BorrowerService.log (services/borrowerService.ts:63:15)

    console.log
      üîé Recherche emprunteurs - query: Test

      at BorrowerService.log (services/borrowerService.ts:57:13)

    console.log
      ‚úÖ R√©sultats de recherche: 1

      at BorrowerService.log (services/borrowerService.ts:63:15)

PASS __tests__/services/authService.test.ts

Test Suites: 1 failed, 12 passed, 13 total
Tests:       1 failed, 117 passed, 118 total
Snapshots:   1 passed, 1 total
Time:        2.184 s, estimated 3 s
Ran all test suites.
